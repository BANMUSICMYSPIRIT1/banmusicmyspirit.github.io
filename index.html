<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Get Coins — Demo</title>
<style>
  :root{
    --tiktok-red:#e02020;
    --muted:#777;
    --sheet-bg:#fff;
    --green:#16a34a;
    --blue:#1e90ff;
    --overlay: rgba(0,0,0,0.35);
  }

  /* ---------- base ---------- */
  html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;-webkit-font-smoothing:antialiased;}
  .container{max-width:400px;margin:18px auto;padding:15px;border:1px solid #ddd;border-radius:10px;background:#fff}

  /* ---------- header + inputs ---------- */
  .header{display:flex;justify-content:center;align-items:center;font-weight:900;font-size:20px;position:relative}
  .header-icons{position:absolute;right:10px;display:flex;gap:10px}
  .circle{border:1px solid #000;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:pointer}

  .username-bar{display:flex;align-items:center;margin:14px 0;border:1px solid #ddd;border-radius:20px;padding:8px 12px}
  .username-bar img{width:30px;margin-right:10px}
  .username-bar input{border:none;outline:none;flex:1;font-size:15px}

  .recharge-title{font-weight:bold;margin-top:6px;font-size:16px}
  .recharge-sub{color:#b22222;font-size:14px;margin:6px 0 14px 0}

  /* ---------- coin grid ---------- */
  .coin-list{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  .coin-item{
    border:1px solid #ddd;border-radius:8px;text-align:center;padding:12px 8px;font-size:14px;cursor:pointer;transition:all .14s;display:flex;flex-direction:column;align-items:center;user-select:none;
  }
  .coin-item svg{width:36px;height:36px;margin-bottom:8px;display:block}
  .coin-count{font-size:18px;font-weight:800;line-height:1}
  .coin-price{font-size:13px;color:#444;margin-top:6px;font-weight:500}
  .coin-item.custom input{width:72%;text-align:center;border:none;outline:none;font-size:14px;margin-top:8px;padding:6px 4px;border-radius:6px;background:#fff;box-shadow:inset 0 0 0 1px #eee}
  .coin-item.active{border:2px solid var(--tiktok-red);background:#fff0f0;box-shadow:0 1px 6px rgba(224,32,32,0.06)}

  .invite{margin:18px 0 6px}
  .invite img{width:23px;margin-right:8px;vertical-align:middle}
  .invite p{margin:0;font-size:14px;display:flex;align-items:center;gap:8px}
  .invite small{font-size:12px;color:gray;margin-top:4px;display:block}

  .footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;margin-top:16px}
  .footer .right{color:#b22222;cursor:pointer}
  .payment-logos{margin:12px 0;display:flex;justify-content:center;gap:14px}
  .payment-logos img{width:40px}
  .buy-btn{display:block;width:100%;padding:14px;text-align:center;background:var(--tiktok-red);color:white;border:none;border-radius:8px;font-size:16px;cursor:pointer;margin-top:8px}

  /* ========== Modal (centered popup) ========== */
  .overlay {
    position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:var(--overlay);z-index:900;
    transition:opacity .18s ease;
  }
  .overlay.show{display:flex;opacity:1}
  .modal {
    width:92%;
    max-width:420px;
    background:var(--sheet-bg);
    border-radius:14px;
    box-shadow:0 20px 50px rgba(0,0,0,0.25);
    transform:translateY(12px);
    opacity:0;
    transition:transform .28s cubic-bezier(.2,.9,.2,1),opacity .22s;
    max-height:86vh;
    overflow:auto;
  }
  .overlay.show .modal{transform:translateY(0);opacity:1}

  .modal-body{padding:18px}

  /* modal header */
  .modal-header{display:flex;align-items:center;justify-content:center;position:relative;padding-bottom:6px}
  .modal-back{position:absolute;left:12px;top:8px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:22px;font-weight:900;padding:6px;border-radius:8px}
  .modal-title{font-weight:700;font-size:18px}
  .modal-help{position:absolute;right:12px;top:8px;border:1px solid #ddd;border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;font-size:16px;color:#333}

  /* secure payment centered text (no logo) */
  .secure-row{display:flex;justify-content:center;align-items:center;font-size:14px;font-weight:700;color:var(--green);margin:8px 0 14px}
  .secure-row .arrow{margin-left:8px;color:var(--green);font-weight:700}

  /* rows */
  .row{display:flex;justify-content:space-between;align-items:center;padding:12px 6px;border-bottom:1px solid #f1f1f1}
  .row .left{color:#333}
  .row .right{color:#222;font-weight:700}
  .subrow{font-size:13px;color:var(--muted);padding:8px 6px 10px 6px}

  /* payment methods */
  .pm-list{padding-top:8px}
  .pm-item{display:flex;align-items:center;gap:12px;padding:12px 6px;border-radius:8px;cursor:pointer}
  .pm-item:hover{background:#fafafa}
  .pm-left{display:flex;align-items:center;gap:12px;flex:1}
  .pm-icon{width:34px;height:24px;border-radius:4px;display:flex;align-items:center;justify-content:center;background:#fff;border:1px solid #eee}
  .pm-title{font-size:15px;color:#222}
  .pm-radio{width:18px;height:18px;border-radius:50%;border:2px solid #ccc;display:flex;align-items:center;justify-content:center;position:relative}
  .pm-radio .dot{width:10px;height:10px;border-radius:50%;background:transparent;transition:all .12s}
  .pm-selected .pm-radio{border-color:var(--tiktok-red)}
  .pm-selected .pm-radio .dot{background:var(--blue)}
  .pm-right {margin-left:8px}

  .notice{font-size:12px;color:#888;margin-top:12px;display:flex;align-items:center;gap:8px}
  .notice .red{color:var(--tiktok-red);font-weight:700}
  .notice .chev{margin-left:auto;color:#888}

  .total-row{display:flex;justify-content:space-between;align-items:center;padding:14px 6px;font-size:16px;font-weight:800;border-top:1px solid #eee;margin-top:10px}
  .pay-now-btn{display:block;width:100%;padding:14px;background:var(--tiktok-red);color:#fff;border:none;border-radius:10px;font-size:16px;margin-top:12px;cursor:pointer}

  /* success */
  .success {
    position:fixed;left:50%;top:40%;transform:translate(-50%,-40%);background:#fff;padding:18px;border-radius:10px;box-shadow:0 8px 30px rgba(0,0,0,.15);display:none;min-width:280px;text-align:center;z-index:1100;
  }
  .success.show{display:block}
  .success .ok{margin-top:12px;padding:10px 12px;background:var(--tiktok-red);color:#fff;border:none;border-radius:8px;cursor:pointer}

  @media (max-width:420px){
    .coin-item svg{width:32px;height:32px}
    .modal{margin:16px}
  }
</style>
</head>
<body>

  <!-- MAIN PAGE (kept exactly as requested visually) -->
  <div class="container" id="mainPage" aria-label="Get Coins page">
    <div class="header"><span>Get Coins</span>
      <div class="header-icons" aria-hidden="true">
        <div class="circle">…</div>
        <div class="circle">?</div>
      </div>
    </div>

    <div class="username-bar">
      <img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg" alt="TikTok logo">
      <input id="usernameInput" type="text" placeholder="Enter username (e.g. khurram_gujjar786)" aria-label="Enter username">
    </div>

    <div class="recharge-title">Recharge</div>
    <div class="recharge-sub">Save around 25% with a lower third-party service fee.</div>

    <div class="coin-list" id="coinList">
      <!-- Each tile uses the inline SVG coin you requested (gold + multi-layer) -->
      <div class="coin-item active" data-coins="30" data-price="0.31">
        <!-- inline TikTok coin SVG (vector) -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">30</div>
        <div class="coin-price">$0.31</div>
      </div>

      <div class="coin-item" data-coins="350" data-price="3.65">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">350</div>
        <div class="coin-price">$3.65</div>
      </div>

      <div class="coin-item" data-coins="700" data-price="7.25">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">700</div>
        <div class="coin-price">$7.25</div>
      </div>

      <div class="coin-item" data-coins="1400" data-price="14.49">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">1400</div>
        <div class="coin-price">$14.49</div>
      </div>

      <div class="coin-item" data-coins="3500" data-price="36.20">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">3500</div>
        <div class="coin-price">$36.20</div>
      </div>

      <div class="coin-item custom">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
          <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
          <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
        </svg>
        <div class="coin-count">Custom</div>
        <input id="customCoins" type="number" placeholder="Coins" min="1" aria-label="Custom coin amount">
        <div id="customPrice" style="margin-top:6px;font-weight:700"></div>
      </div>
    </div>

    <div class="invite">
      <p><img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="invite"> Invite & Get Rewards</p>
      <small>check out this new feature!</small>
    </div>

    <div class="footer">
      <span>special offer</span>
      <span class="right">unlock 5% cash back &gt;</span>
    </div>

    <div class="payment-logos" aria-hidden="true">
      <img src="https://cdn-icons-png.flaticon.com/512/196/196578.png" alt="Visa">
      <img src="https://cdn-icons-png.flaticon.com/512/196/196561.png" alt="MasterCard">
      <img src="https://cdn-icons-png.flaticon.com/512/196/196566.png" alt="Bank">
      <img src="https://cdn-icons-png.flaticon.com/512/196/196565.png" alt="PayPal">
    </div>

    <button id="buyBtn" class="buy-btn" aria-live="polite">Buy for $0.31</button>
  </div>

  <!-- Overlay + Modal (Order Summary) -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="orderTitle">
      <div class="modal-body">
        <div class="modal-header">
          <div class="modal-back" id="modalBack" title="Back" aria-label="Back">&larr;</div>
          <div class="modal-title" id="orderTitle">Order summary</div>
          <div class="modal-help" title="Help" aria-label="Help">?</div>
        </div>

        <!-- centered secure payment text (logo removed) -->
        <div class="secure-row" aria-hidden="true">
          <div>Secure payment <span class="arrow">&gt;</span></div>
        </div>

        <!-- account & coins -->
        <div class="row">
          <div class="left">Account</div>
          <div class="right" id="accountName">username_here</div>
        </div>

        <div class="row" style="border-bottom:1px solid #f1f1f1;">
          <div class="left" id="coinsLabel">30 Coins</div>
          <div class="right" id="amountLabel">$0.31</div>
        </div>

        <!-- payment methods -->
        <div style="padding-top:12px;font-weight:700;color:#222">Payment method</div>
        <div class="pm-list" id="pmList" role="listbox" aria-label="Payment methods">
          <div class="pm-item pm-selected" data-method="card" tabindex="0" role="option" aria-selected="true">
            <div class="pm-left">
              <div style="width:28px;font-weight:700;font-size:20px;">+</div>
              <div class="pm-title">Add debit/credit card</div>
            </div>
            <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
          </div>

          <div class="pm-item" data-method="apple" tabindex="0" role="option" aria-selected="false">
            <div class="pm-left">
              <div class="pm-icon" aria-hidden="true" style="font-size:13px;"></div>
              <div class="pm-title">Apple Pay</div>
            </div>
            <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
          </div>

          <div class="pm-item" data-method="paypal" tabindex="0" role="option" aria-selected="false">
            <div class="pm-left">
              <div class="pm-icon" aria-hidden="true" style="font-size:13px;">P</div>
              <div class="pm-title">PayPal</div>
            </div>
            <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
          </div>
        </div>

        <div class="notice" role="note" aria-live="polite" style="margin-top:12px">
          <div style="color:#888;font-size:13px">By tapping <span class="red">Pay now</span> to make a purchase, you acknowledge that you are purchasing a limited license to access this</div>
          <div class="chev" aria-hidden="true">&#9660;</div>
        </div>

        <div class="total-row">
          <div>Total</div><div id="totalAmount">$0.31</div>
        </div>

        <button id="payNow" class="pay-now-btn">Pay Now</button>
      </div>
    </div>
  </div>

  <!-- success -->
  <div class="success" id="successBox" role="alert" aria-live="assertive">
    <div style="font-size:22px;margin-bottom:8px">✅ Payment Successful</div>
    <div id="successText" style="color:#444">Your coins will be added to the account shortly.</div>
    <button class="ok" id="successOk">OK</button>
  </div>

<script>
  // Helpers
  function money(n){
    const num = Number(n) || 0;
    return '$' + num.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
  }
  function intWithCommas(n){ return (Number(n)||0).toLocaleString(); }

  // Elements
  const coinItems = document.querySelectorAll('.coin-item');
  const buyBtn = document.getElementById('buyBtn');
  const usernameInput = document.getElementById('usernameInput');
  const customInput = document.getElementById('customCoins');
  const customPrice = document.getElementById('customPrice');

  const overlay = document.getElementById('overlay');
  const modalBack = document.getElementById('modalBack');
  const accountName = document.getElementById('accountName');
  const coinsLabel = document.getElementById('coinsLabel');
  const amountLabel = document.getElementById('amountLabel');
  const totalAmount = document.getElementById('totalAmount');

  const pmList = document.getElementById('pmList');
  const payNow = document.getElementById('payNow');

  const successBox = document.getElementById('successBox');
  const successOk  = document.getElementById('successOk');

  // State
  let selectedCoins = 30;
  let selectedPrice = 0.31;
  let selectedPM = 'card';

  // Set Buy button text
  function setBuyLabel(amount){
    buyBtn.textContent = `Buy for ${money(amount)}`;
  }
  setBuyLabel(selectedPrice);

  // Coin selection
  coinItems.forEach(item=>{
    item.addEventListener('click', (e)=>{
      if(item.classList.contains('custom') && e.target === customInput) return;
      coinItems.forEach(c=>c.classList.remove('active'));
      item.classList.add('active');

      if(item.classList.contains('custom')){
        if(customInput) customInput.focus();
        const val = Number(customInput?.value) || 0;
        if(val>0){
          const price = val * 0.0103333333;
          customPrice.textContent = money(price);
          setBuyLabel(price);
          selectedCoins = val;
          selectedPrice = price;
        } else {
          setBuyLabel(0);
          customPrice.textContent = '';
        }
        return;
      }

      selectedCoins = Number(item.dataset.coins) || 0;
      selectedPrice = Number(item.dataset.price) || 0;
      if(customInput){ customInput.value=''; customPrice.textContent=''; }
      setBuyLabel(selectedPrice);
    });
  });

  if(customInput){
    customInput.addEventListener('input', ()=>{
      coinItems.forEach(c=>c.classList.remove('active'));
      const customItem = customInput.closest('.coin-item');
      if(customItem) customItem.classList.add('active');
      const coins = Number(customInput.value) || 0;
      if(coins>0){
        const price = coins * 0.0103333333;
        customPrice.textContent = money(price);
        setBuyLabel(price);
        selectedCoins = coins;
        selectedPrice = price;
      } else {
        customPrice.textContent = '';
        setBuyLabel(0);
      }
    });
  }

  // Open modal (order summary)
  function openModal(){
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');
    const user = (usernameInput.value || '').trim() || 'username_here';
    accountName.textContent = user;
    coinsLabel.textContent = `${intWithCommas(selectedCoins)} Coins`;
    amountLabel.textContent = money(selectedPrice);
    totalAmount.textContent = money(selectedPrice);
    payNow.textContent = `Pay ${money(selectedPrice)}`;
    // focus first payment option for keyboard users
    const firstPM = pmList.querySelector('.pm-item');
    if(firstPM) firstPM.focus();
  }

  function closeModal(){
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
  }

  buyBtn.addEventListener('click', ()=> {
    openModal();
  });

  modalBack.addEventListener('click', ()=> {
    closeModal();
  });

  // Clicking outside modal closes it (but protect important clicks)
  overlay.addEventListener('click', (ev)=>{
    if(ev.target === overlay){
      closeModal();
    }
  });

  // Payment method selection
  pmList.addEventListener('click', (ev)=>{
    const item = ev.target.closest('.pm-item');
    if(!item) return;
    pmList.querySelectorAll('.pm-item').forEach(i=>{
      i.classList.remove('pm-selected');
      i.setAttribute('aria-selected','false');
    });
    item.classList.add('pm-selected');
    item.setAttribute('aria-selected','true');
    selectedPM = item.dataset.method;
  });

  // Keyboard support
  pmList.querySelectorAll('.pm-item').forEach(i=>{
    i.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' || e.key === ' '){
        e.preventDefault();
        i.click();
      }
    });
  });

  // Pay Now (demo)
  payNow.addEventListener('click', ()=>{
    if((Number(selectedPrice) || 0) <= 0){
      alert('Please choose a valid coin amount.');
      return;
    }
    successBox.classList.add('show');
    document.getElementById('successText').textContent = `${intWithCommas(selectedCoins)} coins purchased for ${money(selectedPrice)} and will be credited to ${accountName.textContent}.`;
  });

  successOk.addEventListener('click', ()=>{
    successBox.classList.remove('show');
    closeModal();
  });

  // init default selection
  (function init(){
    const active = document.querySelector('.coin-item.active') || document.querySelector('.coin-item');
    if(active && !active.classList.contains('custom')){
      selectedCoins = Number(active.dataset.coins) || selectedCoins;
      selectedPrice = Number(active.dataset.price) || selectedPrice;
      setBuyLabel(selectedPrice);
      <!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Get Coins — Demo</title>
<style>
  :root{
    --tiktok-red:#e02020;
    --muted:#777;
    --sheet-bg:#fff;
    --green:#16a34a;
    --blue:#1e90ff;
    --overlay: rgba(0,0,0,0.35);
    --pale-pink: #ffeef0; /* processing screen tint */
  }

/* ---------- base ---------- */
html,body{height:100%;margin:0;font-family:Arial,Helvetica,sans-serif;-webkit-font-smoothing:antialiased;}
.container{max-width:400px;margin:18px auto;padding:15px;border:1px solid #ddd;border-radius:10px;background:#fff}

/* ---------- header + inputs ---------- */
.header{display:flex;justify-content:center;align-items:center;font-weight:900;font-size:20px;position:relative}
.header-icons{position:absolute;right:10px;display:flex;gap:10px}
.circle{border:1px solid #000;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:pointer}

.username-bar{display:flex;align-items:center;margin:14px 0;border:1px solid #ddd;border-radius:20px;padding:8px 12px}
.username-bar img{width:30px;margin-right:10px}
.username-bar input{border:none;outline:none;flex:1;font-size:15px}

.recharge-title{font-weight:bold;margin-top:6px;font-size:16px}
.recharge-sub{color:#b22222;font-size:14px;margin:6px 0 14px 0}

/* ---------- coin grid ---------- */
.coin-list{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.coin-item{
border:1px solid #ddd;border-radius:8px;text-align:center;padding:12px 8px;font-size:14px;cursor:pointer;transition:all .14s;display:flex;flex-direction:column;align-items:center;user-select:none;
}
.coin-item svg{width:36px;height:36px;margin-bottom:8px;display:block}
.coin-count{font-size:18px;font-weight:800;line-height:1}
.coin-price{font-size:13px;color:#444;margin-top:6px;font-weight:500}
.coin-item.custom input{width:72%;text-align:center;border:none;outline:none;font-size:14px;margin-top:8px;padding:6px 4px;border-radius:6px;background:#fff;box-shadow:inset 0 0 0 1px #eee}
.coin-item.active{border:2px solid var(--tiktok-red);background:#fff0f0;box-shadow:0 1px 6px rgba(224,32,32,0.06)}

.invite{margin:18px 0 6px}
.invite img{width:23px;margin-right:8px;vertical-align:middle}
.invite p{margin:0;font-size:14px;display:flex;align-items:center;gap:8px}
.invite small{font-size:12px;color:gray;margin-top:4px;display:block}

.footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;margin-top:16px}
.footer .right{color:#b22222;cursor:pointer}
.payment-logos{margin:12px 0;display:flex;justify-content:center;gap:14px}
.payment-logos img{width:40px}
.buy-btn{display:block;width:100%;padding:14px;text-align:center;background:var(--tiktok-red);color:white;border:none;border-radius:8px;font-size:16px;cursor:pointer;margin-top:8px}

/* ========== Half-sheet (order summary) ========== */
.sheet {
position:fixed; left:0; right:0; bottom:0; margin:auto; width:100%; max-width:420px; height:0; pointer-events:none;
}
.sheet-inner {
pointer-events:auto;
position:fixed;
left:50%;
transform:translateX(-50%);
bottom:-100%;
width:100%;
max-width:420px;
background:var(--sheet-bg);
border-top-left-radius:16px;
border-top-right-radius:16px;
box-shadow:0 -8px 30px rgba(0,0,0,0.12);
transition:bottom .28s cubic-bezier(.2,.9,.2,1),opacity .2s;
padding:18px;
height:48vh; /* half-ish */
overflow:auto;
}
.sheet.open .sheet-inner{bottom:6px}

.sheet-header{display:flex;align-items:center;justify-content:center;position:relative;padding-bottom:6px}
.sheet-back{position:absolute;left:10px;top:6px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:18px}
.sheet-title{font-weight:700;font-size:18px}
.sheet-help{position:absolute;right:12px;top:6px;border:1px solid #ddd;border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;font-size:16px;color:#333}

.secure-row{display:flex;justify-content:center;align-items:center;font-size:14px;font-weight:700;color:var(--green);margin:8px 0 12px}
.secure-row .arrow{margin-left:8px;color:var(--green);font-weight:700}

.row{display:flex;justify-content:space-between;align-items:center;padding:12px 6px;border-bottom:1px solid #f1f1f1}
.row .left{color:#333}
.row .right{color:#222;font-weight:700}
.pm-list{padding-top:8px}
.pm-item{display:flex;align-items:center;gap:12px;padding:12px 6px;border-radius:8px;cursor:pointer}
.pm-item:hover
.pm-left{display:flex;align-items:center;gap:12px;flex:1}
.pm-icon{width:34px;height:24px;border-radius:4px;display:flex;align-items:center;justify-content:center;background:#fff;border:1px solid #eee}
.pm-title{font-size:15px;color:#222}
.pm-radio{width:18px;height:18px;border-radius:50%;border:2px solid #ccc;display:flex;align-items:center;justify-content:center;position:relative}
.pm-radio .dot{width:10px;height:10px;border-radius:50%;background:transparent;transition:all .12s}
.pm-selected .pm-radio{border-color:var(--tiktok-red)}
.pm-selected .pm-radio .dot{background:var(--blue)}

.notice{font-size:12px;color:#888;margin-top:12px;display:flex;align-items:center;gap:8px}
.total-row{display:flex;justify-content:space-between;align-items:center;padding:14px 6px;font-size:16px;font-weight:800;border-top:1px solid #eee;margin-top:10px}
.pay-now-btn{display:block;width:100%;padding:14px;background:var(--tiktok-red);color:#fff;border:none;border-radius:10px;font-size:16px;margin-top:12px;cursor:pointer}

/* ========== FULL-SCREEN Processing Page ========== */
.processing-screen {
position:fixed;
inset:0;
display:none;
align-items:center;
justify-content:center;
background:var(--pale-pink);
z-index:1200;
flex-direction:column;
padding:24px;
}
.processing-screen.show{display:flex}

/* animated circles */
.loader {
position:relative;
width:120px;
height:120px;
margin-bottom:18px;
}
.circle-blob {
position:absolute;
top:50%;
left:50%;
width:64px;
height:64px;
border-radius:50%;
transform:translate(-50%,-50%);
mix-blend-mode:screen;
box-shadow:0 8px 24px rgba(0,0,0,0.08);
}
.circle-blob.blue{background:var(--blue); animation:moveBlue 1.2s ease-in-out infinite;}
.circle-blob.red{background:#ff385c; animation:moveRed 1.2s ease-in-out infinite;}

/* animations move in/out and slightly scale */
@keyframes moveBlue {
0%   { transform: translate(-70%,-50%) scale(1); opacity:0.95; }
50%  { transform: translate(-32%,-50%) scale(1.05); opacity:1; }
100% { transform: translate(-70%,-50%) scale(1); opacity:0.95; }
}
@keyframes moveRed {
0%   { transform: translate(-30%,-50%) scale(1); opacity:0.95; }
50%  { transform: translate(10%,-50%) scale(1.05); opacity:1; }
100% { transform: translate(-30%,-50%) scale(1); opacity:0.95; }
}

.processing-title{font-size:20px;font-weight:800;margin-bottom:6px;color:#111}
.processing-sub{font-size:14px;color:#444;margin-bottom:12px}

.timer-box{
font-family:monospace;
font-weight:700;
font-size:18px;
padding:8px 12px;
border-radius:8px;
background:rgba(0,0,0,0.04);
color:#111;
}

/* Success full-screen */
.success-full {
position:fixed;
inset:0;
display:none;
align-items:center;
justify-content:center;
background:var(--pale-pink);
z-index:1300;
flex-direction:column;
padding:24px;
}
.success-full.show{display:flex}
.check {
width:88px;height:88px;border-radius:50%;background:var(--green);display:flex;align-items:center;justify-content:center;color:#fff;font-size:44px;margin-bottom:14px;
box-shadow:0 12px 40px rgba(22,163,74,0.18);
}
.success-title{font-size:20px;font-weight:800;margin-bottom:6px}
.success-sub{font-size:14px;color:#444;margin-bottom:14px}

@media (max-width:420px){
.loader{width:92px;height:92px}
.circle-blob{width:56px;height:56px}
}

</style>
</head>
<body>

  <!-- MAIN PAGE (unchanged visual layout) -->

  <div class="container" id="mainPage" aria-label="Get Coins page">
    <div class="header"><span>Get Coins</span>
      <div class="header-icons" aria-hidden="true">
        <div class="circle">…</div>
        <div class="circle">?</div>
      </div>
    </div>

```
<div class="username-bar">
  <img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg" alt="TikTok logo">
  <input id="usernameInput" type="text" placeholder="Enter username (e.g. khurram_gujjar786)" aria-label="Enter username">
</div>

<div class="recharge-title">Recharge</div>
<div class="recharge-sub">Save around 25% with a lower third-party service fee.</div>

<div class="coin-list" id="coinList">
  <!-- inline coin SVGs kept as requested -->
  <div class="coin-item active" data-coins="30" data-price="0.31">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">30</div>
    <div class="coin-price">$0.31</div>
  </div>

  <div class="coin-item" data-coins="350" data-price="3.65">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">350</div>
    <div class="coin-price">$3.65</div>
  </div>

  <div class="coin-item" data-coins="700" data-price="7.25">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">700</div>
    <div class="coin-price">$7.25</div>
  </div>

  <div class="coin-item" data-coins="1400" data-price="14.49">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">1400</div>
    <div class="coin-price">$14.49</div>
  </div>

  <div class="coin-item" data-coins="3500" data-price="36.20">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">3500</div>
    <div class="coin-price">$36.20</div>
  </div>

  <div class="coin-item custom">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" role="img" aria-hidden="true">
      <circle cx="32" cy="32" r="30" fill="#FFD166" stroke="#E08A00" stroke-width="3"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#111"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#69C9D0" opacity="0.85" transform="translate(-2,2)"/>
      <path d="M38 20v4.5c2.5 1.8 5 2.7 7 2.8v5c-3-.1-5.6-1-7-2V42c0 6-4.5 10-10 10s-10-4-10-10 4.5-10 10-10c1.2 0 2.5.2 3.5.6v5.2c-1-.5-2-.8-3.5-.8-3 0-5 2-5 5s2 5 5 5 5-2 5-5V20h5z" fill="#EE1D52" opacity="0.75" transform="translate(2,-2)"/>
    </svg>
    <div class="coin-count">Custom</div>
    <input id="customCoins" type="number" placeholder="Coins" min="1" aria-label="Custom coin amount">
    <div id="customPrice" style="margin-top:6px;font-weight:700"></div>
  </div>
</div>

<div class="invite">
  <p><img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" alt="invite"> Invite & Get Rewards</p>
  <small>check out this new feature!</small>
</div>

<div class="footer">
  <span>special offer</span>
  <span class="right">unlock 5% cash back &gt;</span>
</div>

<div class="payment-logos" aria-hidden="true">
  <img src="https://cdn-icons-png.flaticon.com/512/196/196578.png" alt="Visa">
  <img src="https://cdn-icons-png.flaticon.com/512/196/196561.png" alt="MasterCard">
  <img src="https://cdn-icons-png.flaticon.com/512/196/196566.png" alt="Bank">
  <img src="https://cdn-icons-png.flaticon.com/512/196/196565.png" alt="PayPal">
</div>

<button id="buyBtn" class="buy-btn" aria-live="polite">Buy for $0.31</button>
```

  </div>

  <!-- Half-sheet Order Summary -->

  <div class="sheet" id="sheetRoot" aria-hidden="true">
    <div class="sheet-inner" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
      <div class="sheet-header">
        <div class="sheet-back" id="sheetBack" title="Back" aria-label="Back">&larr;</div>
        <div class="sheet-title" id="sheetTitle">Order summary</div>
        <div class="sheet-help" title="Help" aria-hidden="true">?</div>
      </div>

```
  <div class="secure-row">Secure payment <span class="arrow">&gt;</span></div>

  <div class="row">
    <div class="left">Account</div>
    <div class="right" id="accountName">username_here</div>
  </div>
  <div class="row" style="border-bottom:1px solid #f1f1f1;">
    <div class="left" id="coinsLabel">30 Coins</div>
    <div class="right" id="amountLabel">$0.31</div>
  </div>

  <div style="padding-top:10px;font-weight:700;color:#222">Payment method</div>
  <div class="pm-list" id="pmList">
    <div class="pm-item pm-selected" data-method="card" tabindex="0">
      <div class="pm-left"><div style="width:28px;font-weight:700;font-size:20px;">+</div><div class="pm-title">Add debit/credit card</div></div>
      <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
    </div>

    <div class="pm-item" data-method="apple" tabindex="0">
      <div class="pm-left"><div class="pm-icon" aria-hidden="true" style="font-size:13px;"></div><div class="pm-title">Apple Pay</div></div>
      <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
    </div>

    <div class="pm-item" data-method="paypal" tabindex="0">
      <div class="pm-left"><div class="pm-icon" aria-hidden="true" style="font-size:13px;">P</div><div class="pm-title">PayPal</div></div>
      <div class="pm-right"><div class="pm-radio"><div class="dot"></div></div></div>
    </div>
  </div>

  <div class="notice">
    <div style="color:#888;font-size:13px">By tapping <span class="red">Pay now</span> to make a purchase, you acknowledge that you are purchasing a limited license to access this</div>
    <div class="chev" aria-hidden="true">&#9660;</div>
  </div>

  <div class="total-row"><div>Total</div><div id="totalAmount">$0.31</div></div>
  <button id="payNow" class="pay-now-btn">Pay Now</button>
</div>
```

  </div>

  <!-- FULL-SCREEN Processing Page (pale pink) -->

  <div id="processing" class="processing-screen" role="status" aria-hidden="true" aria-live="polite">
    <div class="loader" aria-hidden="true">
      <div class="circle-blob blue" aria-hidden="true"></div>
      <div class="circle-blob red" aria-hidden="true"></div>
    </div>

```
<div class="processing-title">Processing your payment</div>
<div class="processing-sub">This could take few seconds</div>

<div class="timer-box" id="processingTimer">04:57</div>
```

  </div>

  <!-- Success full-screen -->

  <div id="successFull" class="success-full" role="alert" aria-hidden="true" aria-live="assertive">
    <div class="check">✓</div>
    <div class="success-title">Payment successful!</div>
    <div class="success-sub" id="successSub">Your coins will be added to the account shortly.</div>
    <button id="successClose" class="ok" style="margin-top:8px;padding:10px 14px;border-radius:8px;border:none;background:#fff;color:var(--green);font-weight:700;cursor:pointer;">Done</button>
  </div>

<script>
  // helpers
  function money(n){ const num = Number(n)||0; return '$' + num.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2}); }
  function intWithCommas(n){ return (Number(n)||0).toLocaleString(); }

  // elements & state
  const coinItems = document.querySelectorAll('.coin-item');
  const buyBtn = document.getElementById('buyBtn');
  const usernameInput = document.getElementById('usernameInput');
  const customInput = document.getElementById('customCoins');
  const customPrice = document.getElementById('customPrice');

  const sheetRoot = document.getElementById('sheetRoot');
  const sheetBack = document.getElementById('sheetBack');
  const payNow = document.getElementById('payNow');

  const accountName = document.getElementById('accountName');
  const coinsLabel = document.getElementById('coinsLabel');
  const amountLabel = document.getElementById('amountLabel');
  const totalAmount = document.getElementById('totalAmount');

  const pmList = document.getElementById('pmList');

  const processing = document.getElementById('processing');
  const processingTimer = document.getElementById('processingTimer');

  const successFull = document.getElementById('successFull');
  const successClose = document.getElementById('successClose');
  const successSub = document.getElementById('successSub');

  let selectedCoins = 30;
  let selectedPrice = 0.31;
  let selectedPM = 'card';

  // set buy label
  function setBuyLabel(amount){ buyBtn.textContent = `Buy for ${money(amount)}`; }
  setBuyLabel(selectedPrice);

  // coin selection behavior (keeps first page intact visually)
  coinItems.forEach(item=>{
    item.addEventListener('click',(e)=>{
      if(item.classList.contains('custom') && e.target === customInput) return;
      coinItems.forEach(c=>c.classList.remove('active'));
      item.classList.add('active');
      if(item.classList.contains('custom')){
        if(customInput) customInput.focus();
        const val = Number(customInput?.value) || 0;
        if(val>0){
          const price = val * 0.0103333333;
          customPrice.textContent = money(price); setBuyLabel(price);
          selectedCoins = val; selectedPrice = price;
        } else { setBuyLabel(0); customPrice.textContent=''; }
        return;
      }
      selectedCoins = Number(item.dataset.coins) || 0;
      selectedPrice = Number(item.dataset.price) || 0;
      if(customInput){ customInput.value=''; customPrice.textContent=''; }
      setBuyLabel(selectedPrice);
    });
  });

  if(customInput){
    customInput.addEventListener('input',()=>{
      coinItems.forEach(c=>c.classList.remove('active'));
      const customItem = customInput.closest('.coin-item');
      if(customItem) customItem.classList.add('active');
      const coins = Number(customInput.value) || 0;
      if(coins>0){
        const price = coins * 0.0103333333;
        customPrice.textContent = money(price); setBuyLabel(price);
        selectedCoins = coins; selectedPrice = price;
      } else { customPrice.textContent=''; setBuyLabel(0); }
    });
  }

  // half-sheet open/close
  function openSheet(){
    sheetRoot.classList.add('open'); sheetRoot.setAttribute('aria-hidden','false');
    const user = (usernameInput.value||'').trim()||'username_here';
    accountName.textContent = user;
    coinsLabel.textContent = `${intWithCommas(selectedCoins)} Coins`;
    amountLabel.textContent = money(selectedPrice);
    totalAmount.textContent = money(selectedPrice);
    payNow.textContent = `Pay ${money(selectedPrice)}`;
  }
  function closeSheet(){ sheetRoot.classList.remove('open'); sheetRoot.setAttribute('aria-hidden','true'); }
  buyBtn.addEventListener('click', openSheet);
  sheetBack.addEventListener('click', closeSheet);

  // pm selection
  pmList.addEventListener('click', (ev)=>{
    const it = ev.target.closest('.pm-item'); if(!it) return;
    pmList.querySelectorAll('.pm-item').forEach(x=>{ x.classList.remove('pm-selected'); x.setAttribute('aria-selected','false'); });
    it.classList.add('pm-selected'); it.setAttribute('aria-selected','true');
    selectedPM = it.dataset.method;
  });

  // MAIN: clicking Pay Now -> Processing full-screen -> success
  payNow.addEventListener('click', ()=>{
    // validation
    if((Number(selectedPrice)||0) <= 0){
      alert('Please choose a valid coin amount.');
      return;
    }

    // close sheet and show processing screen
    closeSheet();
    showProcessingThenSuccess();
  });

  // processing sequence and timer:
  // user requested the small timer showing 04:57, 04:58, 04:59, 05:00 (one second each)
  function showProcessingThenSuccess(){
    // show processing full-screen
    processing.classList.add('show'); processing.setAttribute('aria-hidden','false');

    // the requested sequence of timestamps (as strings)
    const times = ['04:57','04:58','04:59','05:00'];
    let idx = 0;
    processingTimer.textContent = times[idx];

    const interval = setInterval(()=>{
      idx++;
      if(idx < times.length){
        processingTimer.textContent = times[idx];
      } else {
        clearInterval(interval);
        // small delay to allow the final number to be visible (optional)
        setTimeout(()=> {
          // move to success full-screen
          processing.classList.remove('show');
          processing.setAttribute('aria-hidden','true');

          successFull.classList.add('show');
          successFull.setAttribute('aria-hidden','false');

          // update success message a bit
          successSub.textContent = `${intWithCommas(selectedCoins)} coins purchased for ${money(selectedPrice)} and will be credited to ${ (usernameInput.value||'username_here').trim() || 'username_here' }.`;
        }, 350);
      }
    }, 1000);
  }

  // closing success returns to main page
  successClose.addEventListener('click', ()=>{
    successFull.classList.remove('show');
    successFull.setAttribute('aria-hidden','true');
  });

  // initialize default selection for buy label
  (function init(){
    const active = document.querySelector('.coin-item.active') || document.querySelector('.coin-item');
    if(active && !active.classList.contains('custom')){
      selectedCoins = Number(active.dataset.coins) || selectedCoins;
      selectedPrice = Number(active.dataset.price) || selectedPrice;
      setBuyLabel(selectedPrice);
    }
  })();
</script>

</body>
</html>
    }
  })();
</script>
</body>
</html>
